<!DOCTYPE html><html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>简单的共享 (app) 状态管理  - Flutter 中文文档 - Flutter 社区中文资源 </title>
  <link rel="shortcut icon" href="/images/favicon.png">

  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-ND4LWWZ');</script>
  <!-- End Google Tag Manager -->

  
  <meta name="description" content="Now that you know about [declarative UIprogramming](/docs/development/data-and-backend/state-mgmt/declarative)and the difference between [ephemeral and appstate](/docs/development/data-and-backend/state-mgmt/ephemeral-vs-app),you are ready to learn about simple app state management.On this page, we are going to be using the `scoped_model` package.If you are new to Flutter and you don't have a strong reason to chooseanother approach (Redux, Rx,...">
  <meta name="keywords" content=" ">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@flutterdev">

  <meta property="og:title" content="简单的共享 (app) 状态管理">
  <meta property="og:url" content="https://flutter.dev/docs/development/data-and-backend/state-mgmt/simple">
  <meta property="og:description" content="Now that you know about [declarative UIprogramming](/docs/development/data-and-backend/state-mgmt/declarative)and the difference between [ephemeral and appstate](/docs/development/data-and-backend/state-mgmt/ephemeral-vs-app),you are ready to learn about simple app state management.On this page, we are going to be using the `scoped_model` package.If you are new to Flutter and you don't have a strong reason to chooseanother approach (Redux, Rx,...">
  
  <meta property="og:image" content="https://flutter.dev/images/flutter-logo-sharing.png">

  <link href="/assets/translator/css/material-roboto.css" rel="stylesheet">
  <link rel="stylesheet" type="text/css" href="/assets/main-74a0c308218334fcd85291a957a514973015ea8e4eb76b9abae6e14bb5012f5e.css">
  
  <script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
  <script src="/assets/main-d6b8b8d26e7b4122b3ddf6a5201966d6e2494aaffadaafaf7c571ce5e2fe0aab.js" type="text/javascript"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-122680122-1', 'auto');
    ga('send', 'pageview');
  </script>

  <!--<meta name="google-site-verification" content="HFqxhSbf9YA_0rBglNLzDiWnrHiK_w4cqDh2YD2GEY4" />-->
<link href="/assets/translator/css/translator.css" rel="stylesheet"></head>
<body>
    <!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-ND4LWWZ"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<div id="overlay-under-drawer"></div>

    <header class="site-header">
  <nav class="navbar navbar-expand-md justify-content-start justify-content-md-between">
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <i class="material-icons">menu</i>
    </button>

    <a class="navbar-brand" href="/">
      <img alt="Flutter by Google" height="37" width="129" class="align-middle" src="/assets/flutter-lockup-4cb0ee072ab312e59784d9fbf4fb7ad42688a7fdaea1270ccf6bbf4f34b7e03f.svg">
    </a>

    <div class="collapse navbar-collapse flex-grow-0" id="navbarSupportedContent">
      <div class="site-header__sheet-bg" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"></div>
      <div class="site-header__sheet">
        <ul class="navbar-nav">

          <li class="nav-item">
            <a class="nav-link active" href="/docs">开发文档</a>
          </li>
          <div class="site-sidebar site-sidebar--header d-md-none">
            <ul class="nav flex-column"><li class="nav-item">
      <a class="nav-link collapsed" data-toggle="collapse" href="#sidenav-1" role="button" aria-expanded="false" aria-controls="sidenav-1">开始使用 Flutter</a>

      <ul class="nav flex-column flex-nowrap collapse " id="sidenav-1">
        <li class="nav-item">
    <a class="nav-link" href="/docs/get-started/install">1. 安装和环境配置</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/docs/get-started/editor">2. 编辑工具设定</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/docs/get-started/test-drive">3. 开发体验初探</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/docs/get-started/codelab">4. 编写第一个 Flutter 应用</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/docs/get-started/learn-more">5. 了解更多</a>
  </li><div class="dropdown-divider"></div><li class="nav-item">
    <a class="nav-link collapsable" data-toggle="collapse" data-target="#sidenav-1-7" href="#sidenav-1-7" role="button" aria-expanded="true" aria-controls="sidenav-1-7">拥有其他平台开发经验？
    </a>
    <ul class="nav flex-column flex-nowrap collapse show" id="sidenav-1-7">
      <li class="nav-item">
    <a class="nav-link" href="/docs/get-started/flutter-for/android-devs">给 Android 开发者的 Flutter 指南</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/docs/get-started/flutter-for/ios-devs">给 iOS 开发者的 Flutter 指南</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/docs/get-started/flutter-for/react-native-devs">给 React Native 开发者的 Flutter 指南</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/docs/get-started/flutter-for/web-devs">给 Web 开发者的 Flutter 指南</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/docs/get-started/flutter-for/xamarin-forms-devs">给 Xamarin.Forms 开发者的 Flutter 指南</a>
  </li></ul>
  </li>
<li class="nav-item">
    <a class="nav-link" href="https://www.dartlang.org/guides/language" target="_blank" rel="noopener">Dart 语言概览<i class="fas fa-external-link-alt"></i></a>
  </li>
</ul>
    </li><li class="nav-item">
      <a class="nav-link collapsed" data-toggle="collapse" href="#sidenav-2" role="button" aria-expanded="false" aria-controls="sidenav-2">教程和样例代码</a>

      <ul class="nav flex-column flex-nowrap collapse " id="sidenav-2">
        <li class="nav-item">
    <a class="nav-link" href="https://github.com/flutter/samples/blob/master/INDEX.md" target="_blank" rel="noopener">GitHub 上样例应用<i class="fas fa-external-link-alt"></i></a>
  </li><li class="nav-item">
    <a class="nav-link" href="/docs/cookbook">实用教程 (Cookbook)</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/docs/codelabs">Codelabs</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/docs/reference/tutorials">实践教程</a>
  </li>
</ul>
    </li><li class="nav-item">
      <a class="nav-link active" data-toggle="collapse" href="#sidenav-3" role="button" aria-expanded="true" aria-controls="sidenav-3">开发文档</a>

      <ul class="nav flex-column flex-nowrap collapse show" id="sidenav-3">
        <li class="nav-item">
    <a class="nav-link collapsable collapsed" data-toggle="collapse" data-target="#sidenav-3-1" href="/docs/development/ui" role="button" aria-expanded="false" aria-controls="sidenav-3-1">用户界面
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-3-1">
      <li class="nav-item">
    <a class="nav-link" href="/docs/development/ui/widgets-intro">Widgets 介绍</a>
  </li><li class="nav-item">
    <a class="nav-link collapsable collapsed" data-toggle="collapse" data-target="#sidenav-3-1-2" href="#sidenav-3-1-2" role="button" aria-expanded="false" aria-controls="sidenav-3-1-2">布局构建
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-3-1-2">
      <li class="nav-item">
    <a class="nav-link" href="/docs/development/ui/layout">Flutter 中的布局</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/docs/development/ui/layout/tutorial">布局构建教程</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/docs/development/ui/layout/box-constraints">边界约束 (Box constraints)</a>
  </li>
  </ul>
  </li>
<li class="nav-item">
    <a class="nav-link" href="/docs/development/ui/interactive">交互添加</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/docs/development/ui/assets-and-images">资源和图片</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/docs/development/ui/navigation">路由和导航</a>
  </li><li class="nav-item">
    <a class="nav-link collapsable collapsed" data-toggle="collapse" data-target="#sidenav-3-1-6" href="/docs/development/ui/animations" role="button" aria-expanded="false" aria-controls="sidenav-3-1-6">动画效果
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-3-1-6">
      <li class="nav-item">
    <a class="nav-link" href="/docs/development/ui/animations">介绍</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/docs/development/ui/animations/overview">概览</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/docs/development/ui/animations/tutorial">教程</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/docs/development/ui/animations/hero-animations">主动画 (Hero animations)</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/docs/development/ui/animations/staggered-animations">交织动画 (Staggered animations)</a>
  </li>
  </ul>
  </li>
<li class="nav-item">
    <a class="nav-link collapsable collapsed" data-toggle="collapse" data-target="#sidenav-3-1-7" href="/docs/development/ui/advanced" role="button" aria-expanded="false" aria-controls="sidenav-3-1-7">用户界面 (UI) 进阶
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-3-1-7">
      <li class="nav-item">
    <a class="nav-link" href="/docs/development/ui/advanced/slivers">滑动效果 (Slivers)</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/docs/development/ui/advanced/gestures">手势</a>
  </li>
  </ul>
  </li>
<li class="nav-item">
    <a class="nav-link" href="/docs/development/ui/widgets">核心 Widget 目录</a>
  </li></ul>
  </li>
<li class="nav-item">
    <a class="nav-link active collapsable" data-toggle="collapse" data-target="#sidenav-3-2" href="/docs/development/data-and-backend" role="button" aria-expanded="true" aria-controls="sidenav-3-2">数据调用和后端
    </a>
    <ul class="nav flex-column flex-nowrap collapse show" id="sidenav-3-2">
      <li class="nav-item">
    <a class="nav-link active collapsable" data-toggle="collapse" data-target="#sidenav-3-2-1" href="/docs/development/data-and-backend/state-mgmt" role="button" aria-expanded="true" aria-controls="sidenav-3-2-1">状态 (State) 管理
    </a>
    <ul class="nav flex-column flex-nowrap collapse show" id="sidenav-3-2-1">
      <li class="nav-item">
    <a class="nav-link" href="/docs/development/data-and-backend/state-mgmt/intro">状态管理介绍</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/docs/development/data-and-backend/state-mgmt/declarative">声明式的编程思维</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/docs/development/data-and-backend/state-mgmt/ephemeral-vs-app">短时 (ephemeral) 和共享 (app) 状态</a>
  </li>
  <li class="nav-item">
    <a class="nav-link active" href="/docs/development/data-and-backend/state-mgmt/simple">简单的共享 (app) 状态管理</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/docs/development/data-and-backend/state-mgmt/options">状态管理参考</a>
  </li>
  </ul>
  </li>
<li class="nav-item">
    <a class="nav-link" href="/docs/development/data-and-backend/json">JSON 和序列化数据</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/docs/development/data-and-backend/firebase">使用 Firebase</a>
  </li></ul>
  </li>
<li class="nav-item">
    <a class="nav-link collapsable collapsed" data-toggle="collapse" data-target="#sidenav-3-3" href="/docs/development/accessibility-and-localization" role="button" aria-expanded="false" aria-controls="sidenav-3-3">应用的无障碍和国际化
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-3-3">
      <li class="nav-item">
    <a class="nav-link" href="/docs/development/accessibility-and-localization/accessibility">无障碍</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/docs/development/accessibility-and-localization/internationalization">国际化</a>
  </li></ul>
  </li>
<li class="nav-item">
    <a class="nav-link collapsable collapsed" data-toggle="collapse" data-target="#sidenav-3-4" href="/docs/development/platform-integration" role="button" aria-expanded="false" aria-controls="sidenav-3-4">平台集成
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-3-4">
      <li class="nav-item">
    <a class="nav-link" href="/docs/development/platform-integration/platform-channels">撰写双端平台代码 (插件编写实现)</a>
  </li></ul>
  </li>
<li class="nav-item">
    <a class="nav-link collapsable collapsed" data-toggle="collapse" data-target="#sidenav-3-5" href="/docs/development/packages-and-plugins" role="button" aria-expanded="false" aria-controls="sidenav-3-5">Packages (纯 Dart 和原生插件)
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-3-5">
      <li class="nav-item">
    <a class="nav-link" href="/docs/development/packages-and-plugins/using-packages">使用 Packages</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/docs/development/packages-and-plugins/developing-packages">Package 的开发和提交</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/docs/development/packages-and-plugins/background-processes">后台进程</a>
  </li><li class="nav-item">
    <a class="nav-link" href="https://pub.flutter-io.cn/flutter" target="_blank" rel="noopener">Package 网站<i class="fas fa-external-link-alt"></i></a>
  </li></ul>
  </li>
<li class="nav-item">
    <a class="nav-link collapsable collapsed" data-toggle="collapse" data-target="#sidenav-3-6" href="/docs/development/tools" role="button" aria-expanded="false" aria-controls="sidenav-3-6">开发工具和技术细节
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-3-6">
      <li class="nav-item">
    <a class="nav-link" href="/docs/development/tools/android-studio">Android Studio 或类 IntelliJ 系列</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/docs/development/tools/vs-code">Visual Studio Code</a>
  </li><li class="nav-item">
    <a class="nav-link" href="https://flutter.github.io/devtools/" target="_blank" rel="noopener">Dart 调试工具<i class="fas fa-external-link-alt"></i></a>
  </li><li class="nav-item">
    <a class="nav-link collapsable collapsed" data-toggle="collapse" data-target="#sidenav-3-6-4" href="/docs/development/tools/sdk" role="button" aria-expanded="false" aria-controls="sidenav-3-6-4">Flutter SDK
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-3-6-4">
      <li class="nav-item">
    <a class="nav-link" href="/docs/development/tools/sdk/upgrading">版本升级</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/docs/development/tools/sdk/releases">版本列表</a>
  </li>
  </ul>
  </li>
<li class="nav-item">
    <a class="nav-link" href="/docs/development/tools/hot-reload">热重载 (Hot reload)</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/docs/development/tools/formatting">代码格式</a>
  </li><li class="nav-item">
    <a class="nav-link" href="https://flutter.github.io/devtools/inspector" target="_blank" rel="noopener">Flutter Inspector<i class="fas fa-external-link-alt"></i></a>
  </li></ul>
  </li>

</ul>
    </li><li class="nav-item">
      <a class="nav-link collapsed" data-toggle="collapse" href="#sidenav-4" role="button" aria-expanded="false" aria-controls="sidenav-4">测试和调优</a>

      <ul class="nav flex-column flex-nowrap collapse " id="sidenav-4">
        <li class="nav-item">
    <a class="nav-link" href="/docs/testing/debugging">调试 Flutter 应用</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/docs/testing/oem-debuggers">使用原生的调试器</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/docs/testing/build-modes">构建模式 (Debug/Release/Profile)</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/docs/testing">测试 Flutter 应用</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/docs/testing/best-practices">性能优化最佳实践</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/docs/testing/ui-performance">Flutter 性能分析</a>
  </li>
</ul>
    </li><li class="nav-item">
      <a class="nav-link collapsed" data-toggle="collapse" href="#sidenav-5" role="button" aria-expanded="false" aria-controls="sidenav-5">打包部署</a>

      <ul class="nav flex-column flex-nowrap collapse " id="sidenav-5">
        <li class="nav-item">
    <a class="nav-link" href="/docs/deployment/flavors">配置 flavors 构建双端</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/docs/deployment/android">打包和发布到 Android 平台</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/docs/deployment/ios">打包和发布到 iOS 平台</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/docs/deployment/fastlane-cd">使用 fastlane 持续交付</a>
  </li>
</ul>
    </li><li class="nav-item">
      <a class="nav-link collapsed" data-toggle="collapse" href="#sidenav-6" role="button" aria-expanded="false" aria-controls="sidenav-6">资源列表</a>

      <ul class="nav flex-column flex-nowrap collapse " id="sidenav-6">
        <li class="nav-item">
    <a class="nav-link" href="/docs/resources/bootstrap-into-dart">Dart 资源列表</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/docs/resources/inside-flutter">Flutter 工作原理</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/docs/resources/platform-adaptations">平台行为差异和适配</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/docs/resources/technical-overview">技术概览</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/docs/resources/videos">Flutter 技术视频资源</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/docs/resources/faq">常见问题解答</a>
  </li>
</ul>
    </li><li class="nav-item">
      <a class="nav-link " data-toggle="collapse" href="#sidenav-7" role="button" aria-expanded="true" aria-controls="sidenav-7">参考资料</a>

      <ul class="nav flex-column flex-nowrap collapse show" id="sidenav-7">
        <li class="nav-item">
    <a class="nav-link" href="/docs/reference/widgets">Flutter Widget 目录</a>
  </li><li class="nav-item">
    <a class="nav-link" href="https://docs.flutter.cn" target="_blank" rel="noopener">Flutter API 文档<i class="fas fa-external-link-alt"></i></a>
  </li><li class="nav-item">
    <a class="nav-link" href="https://pub.flutter-io.cn/flutter" target="_blank" rel="noopener">Package 网站<i class="fas fa-external-link-alt"></i></a>
  </li>
</ul>
    </li></ul>

          </div>

<!-- 
          <li class="nav-item">
            <a class="nav-link" href="/showcase">Showcase</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/community">Community</a>
          </li>
 -->
        </ul>
        <form action="/search" class="site-header__search form-inline">
          <input class="site-header__searchfield form-control" type="search" name="q" id="q" autocomplete="off" placeholder="Search" aria-label="Search">
        </form>
      </div>
    </div>
    <div class="site-header__social navbar-nav flex-row">
      <a class="nav-item nav-link" href="https://twitter.com/flutterdev"><i class="fab fa-twitter fa-lg"></i></a>
      <a class="nav-item nav-link" href="https://www.youtube.com/flutterdev"><i class="fab fa-youtube fa-lg"></i></a>
      <a class="nav-item nav-link" href="https://github.com/flutter"><i class="fab fa-github fa-lg"></i></a>
    </div>
    <a class="site-header__cta btn btn-primary" href="/docs/get-started/install/">Get started</a>
    </nav>
</header>
<div class="site-banner site-banner--default" role="alert">
    <p>
      We are looking for a Flutter Infrastructure engineer!
      <a href="/jobs/infrastructure" target="_blank" rel="noopener">Learn more</a>.
    </p>

  </div>
<div class="container-fluid position-relative">
  <div class="row flex-xl-nowrap">
    <div class="fixed-col site-sidebar site-sidebar--fixed col-12 col-md-3 col-xl-2 d-none d-md-block" data-fixed-column="">
      <ul class="nav flex-column"><li class="nav-item">
      <a class="nav-link collapsed" data-toggle="collapse" href="#sidenav-1" role="button" aria-expanded="false" aria-controls="sidenav-1">开始使用 Flutter</a>

      <ul class="nav flex-column flex-nowrap collapse " id="sidenav-1">
        <li class="nav-item">
    <a class="nav-link" href="/docs/get-started/install">1. 安装和环境配置</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/docs/get-started/editor">2. 编辑工具设定</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/docs/get-started/test-drive">3. 开发体验初探</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/docs/get-started/codelab">4. 编写第一个 Flutter 应用</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/docs/get-started/learn-more">5. 了解更多</a>
  </li><div class="dropdown-divider"></div><li class="nav-item">
    <a class="nav-link collapsable" data-toggle="collapse" data-target="#sidenav-1-7" href="#sidenav-1-7" role="button" aria-expanded="true" aria-controls="sidenav-1-7">拥有其他平台开发经验？
    </a>
    <ul class="nav flex-column flex-nowrap collapse show" id="sidenav-1-7">
      <li class="nav-item">
    <a class="nav-link" href="/docs/get-started/flutter-for/android-devs">给 Android 开发者的 Flutter 指南</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/docs/get-started/flutter-for/ios-devs">给 iOS 开发者的 Flutter 指南</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/docs/get-started/flutter-for/react-native-devs">给 React Native 开发者的 Flutter 指南</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/docs/get-started/flutter-for/web-devs">给 Web 开发者的 Flutter 指南</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/docs/get-started/flutter-for/xamarin-forms-devs">给 Xamarin.Forms 开发者的 Flutter 指南</a>
  </li></ul>
  </li>
<li class="nav-item">
    <a class="nav-link" href="https://www.dartlang.org/guides/language" target="_blank" rel="noopener">Dart 语言概览<i class="fas fa-external-link-alt"></i></a>
  </li>
</ul>
    </li><li class="nav-item">
      <a class="nav-link collapsed" data-toggle="collapse" href="#sidenav-2" role="button" aria-expanded="false" aria-controls="sidenav-2">教程和样例代码</a>

      <ul class="nav flex-column flex-nowrap collapse " id="sidenav-2">
        <li class="nav-item">
    <a class="nav-link" href="https://github.com/flutter/samples/blob/master/INDEX.md" target="_blank" rel="noopener">GitHub 上样例应用<i class="fas fa-external-link-alt"></i></a>
  </li><li class="nav-item">
    <a class="nav-link" href="/docs/cookbook">实用教程 (Cookbook)</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/docs/codelabs">Codelabs</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/docs/reference/tutorials">实践教程</a>
  </li>
</ul>
    </li><li class="nav-item">
      <a class="nav-link active" data-toggle="collapse" href="#sidenav-3" role="button" aria-expanded="true" aria-controls="sidenav-3">开发文档</a>

      <ul class="nav flex-column flex-nowrap collapse show" id="sidenav-3">
        <li class="nav-item">
    <a class="nav-link collapsable collapsed" data-toggle="collapse" data-target="#sidenav-3-1" href="/docs/development/ui" role="button" aria-expanded="false" aria-controls="sidenav-3-1">用户界面
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-3-1">
      <li class="nav-item">
    <a class="nav-link" href="/docs/development/ui/widgets-intro">Widgets 介绍</a>
  </li><li class="nav-item">
    <a class="nav-link collapsable collapsed" data-toggle="collapse" data-target="#sidenav-3-1-2" href="#sidenav-3-1-2" role="button" aria-expanded="false" aria-controls="sidenav-3-1-2">布局构建
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-3-1-2">
      <li class="nav-item">
    <a class="nav-link" href="/docs/development/ui/layout">Flutter 中的布局</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/docs/development/ui/layout/tutorial">布局构建教程</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/docs/development/ui/layout/box-constraints">边界约束 (Box constraints)</a>
  </li>
  </ul>
  </li>
<li class="nav-item">
    <a class="nav-link" href="/docs/development/ui/interactive">交互添加</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/docs/development/ui/assets-and-images">资源和图片</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/docs/development/ui/navigation">路由和导航</a>
  </li><li class="nav-item">
    <a class="nav-link collapsable collapsed" data-toggle="collapse" data-target="#sidenav-3-1-6" href="/docs/development/ui/animations" role="button" aria-expanded="false" aria-controls="sidenav-3-1-6">动画效果
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-3-1-6">
      <li class="nav-item">
    <a class="nav-link" href="/docs/development/ui/animations">介绍</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/docs/development/ui/animations/overview">概览</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/docs/development/ui/animations/tutorial">教程</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/docs/development/ui/animations/hero-animations">主动画 (Hero animations)</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/docs/development/ui/animations/staggered-animations">交织动画 (Staggered animations)</a>
  </li>
  </ul>
  </li>
<li class="nav-item">
    <a class="nav-link collapsable collapsed" data-toggle="collapse" data-target="#sidenav-3-1-7" href="/docs/development/ui/advanced" role="button" aria-expanded="false" aria-controls="sidenav-3-1-7">用户界面 (UI) 进阶
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-3-1-7">
      <li class="nav-item">
    <a class="nav-link" href="/docs/development/ui/advanced/slivers">滑动效果 (Slivers)</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/docs/development/ui/advanced/gestures">手势</a>
  </li>
  </ul>
  </li>
<li class="nav-item">
    <a class="nav-link" href="/docs/development/ui/widgets">核心 Widget 目录</a>
  </li></ul>
  </li>
<li class="nav-item">
    <a class="nav-link active collapsable" data-toggle="collapse" data-target="#sidenav-3-2" href="/docs/development/data-and-backend" role="button" aria-expanded="true" aria-controls="sidenav-3-2">数据调用和后端
    </a>
    <ul class="nav flex-column flex-nowrap collapse show" id="sidenav-3-2">
      <li class="nav-item">
    <a class="nav-link active collapsable" data-toggle="collapse" data-target="#sidenav-3-2-1" href="/docs/development/data-and-backend/state-mgmt" role="button" aria-expanded="true" aria-controls="sidenav-3-2-1">状态 (State) 管理
    </a>
    <ul class="nav flex-column flex-nowrap collapse show" id="sidenav-3-2-1">
      <li class="nav-item">
    <a class="nav-link" href="/docs/development/data-and-backend/state-mgmt/intro">状态管理介绍</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/docs/development/data-and-backend/state-mgmt/declarative">声明式的编程思维</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/docs/development/data-and-backend/state-mgmt/ephemeral-vs-app">短时 (ephemeral) 和共享 (app) 状态</a>
  </li>
  <li class="nav-item">
    <a class="nav-link active" href="/docs/development/data-and-backend/state-mgmt/simple">简单的共享 (app) 状态管理</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/docs/development/data-and-backend/state-mgmt/options">状态管理参考</a>
  </li>
  </ul>
  </li>
<li class="nav-item">
    <a class="nav-link" href="/docs/development/data-and-backend/json">JSON 和序列化数据</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/docs/development/data-and-backend/firebase">使用 Firebase</a>
  </li></ul>
  </li>
<li class="nav-item">
    <a class="nav-link collapsable collapsed" data-toggle="collapse" data-target="#sidenav-3-3" href="/docs/development/accessibility-and-localization" role="button" aria-expanded="false" aria-controls="sidenav-3-3">应用的无障碍和国际化
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-3-3">
      <li class="nav-item">
    <a class="nav-link" href="/docs/development/accessibility-and-localization/accessibility">无障碍</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/docs/development/accessibility-and-localization/internationalization">国际化</a>
  </li></ul>
  </li>
<li class="nav-item">
    <a class="nav-link collapsable collapsed" data-toggle="collapse" data-target="#sidenav-3-4" href="/docs/development/platform-integration" role="button" aria-expanded="false" aria-controls="sidenav-3-4">平台集成
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-3-4">
      <li class="nav-item">
    <a class="nav-link" href="/docs/development/platform-integration/platform-channels">撰写双端平台代码 (插件编写实现)</a>
  </li></ul>
  </li>
<li class="nav-item">
    <a class="nav-link collapsable collapsed" data-toggle="collapse" data-target="#sidenav-3-5" href="/docs/development/packages-and-plugins" role="button" aria-expanded="false" aria-controls="sidenav-3-5">Packages (纯 Dart 和原生插件)
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-3-5">
      <li class="nav-item">
    <a class="nav-link" href="/docs/development/packages-and-plugins/using-packages">使用 Packages</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/docs/development/packages-and-plugins/developing-packages">Package 的开发和提交</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/docs/development/packages-and-plugins/background-processes">后台进程</a>
  </li><li class="nav-item">
    <a class="nav-link" href="https://pub.flutter-io.cn/flutter" target="_blank" rel="noopener">Package 网站<i class="fas fa-external-link-alt"></i></a>
  </li></ul>
  </li>
<li class="nav-item">
    <a class="nav-link collapsable collapsed" data-toggle="collapse" data-target="#sidenav-3-6" href="/docs/development/tools" role="button" aria-expanded="false" aria-controls="sidenav-3-6">开发工具和技术细节
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-3-6">
      <li class="nav-item">
    <a class="nav-link" href="/docs/development/tools/android-studio">Android Studio 或类 IntelliJ 系列</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/docs/development/tools/vs-code">Visual Studio Code</a>
  </li><li class="nav-item">
    <a class="nav-link" href="https://flutter.github.io/devtools/" target="_blank" rel="noopener">Dart 调试工具<i class="fas fa-external-link-alt"></i></a>
  </li><li class="nav-item">
    <a class="nav-link collapsable collapsed" data-toggle="collapse" data-target="#sidenav-3-6-4" href="/docs/development/tools/sdk" role="button" aria-expanded="false" aria-controls="sidenav-3-6-4">Flutter SDK
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-3-6-4">
      <li class="nav-item">
    <a class="nav-link" href="/docs/development/tools/sdk/upgrading">版本升级</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/docs/development/tools/sdk/releases">版本列表</a>
  </li>
  </ul>
  </li>
<li class="nav-item">
    <a class="nav-link" href="/docs/development/tools/hot-reload">热重载 (Hot reload)</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/docs/development/tools/formatting">代码格式</a>
  </li><li class="nav-item">
    <a class="nav-link" href="https://flutter.github.io/devtools/inspector" target="_blank" rel="noopener">Flutter Inspector<i class="fas fa-external-link-alt"></i></a>
  </li></ul>
  </li>

</ul>
    </li><li class="nav-item">
      <a class="nav-link collapsed" data-toggle="collapse" href="#sidenav-4" role="button" aria-expanded="false" aria-controls="sidenav-4">测试和调优</a>

      <ul class="nav flex-column flex-nowrap collapse " id="sidenav-4">
        <li class="nav-item">
    <a class="nav-link" href="/docs/testing/debugging">调试 Flutter 应用</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/docs/testing/oem-debuggers">使用原生的调试器</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/docs/testing/build-modes">构建模式 (Debug/Release/Profile)</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/docs/testing">测试 Flutter 应用</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/docs/testing/best-practices">性能优化最佳实践</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/docs/testing/ui-performance">Flutter 性能分析</a>
  </li>
</ul>
    </li><li class="nav-item">
      <a class="nav-link collapsed" data-toggle="collapse" href="#sidenav-5" role="button" aria-expanded="false" aria-controls="sidenav-5">打包部署</a>

      <ul class="nav flex-column flex-nowrap collapse " id="sidenav-5">
        <li class="nav-item">
    <a class="nav-link" href="/docs/deployment/flavors">配置 flavors 构建双端</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/docs/deployment/android">打包和发布到 Android 平台</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/docs/deployment/ios">打包和发布到 iOS 平台</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/docs/deployment/fastlane-cd">使用 fastlane 持续交付</a>
  </li>
</ul>
    </li><li class="nav-item">
      <a class="nav-link collapsed" data-toggle="collapse" href="#sidenav-6" role="button" aria-expanded="false" aria-controls="sidenav-6">资源列表</a>

      <ul class="nav flex-column flex-nowrap collapse " id="sidenav-6">
        <li class="nav-item">
    <a class="nav-link" href="/docs/resources/bootstrap-into-dart">Dart 资源列表</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/docs/resources/inside-flutter">Flutter 工作原理</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/docs/resources/platform-adaptations">平台行为差异和适配</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/docs/resources/technical-overview">技术概览</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/docs/resources/videos">Flutter 技术视频资源</a>
  </li><li class="nav-item">
    <a class="nav-link" href="/docs/resources/faq">常见问题解答</a>
  </li>
</ul>
    </li><li class="nav-item">
      <a class="nav-link " data-toggle="collapse" href="#sidenav-7" role="button" aria-expanded="true" aria-controls="sidenav-7">参考资料</a>

      <ul class="nav flex-column flex-nowrap collapse show" id="sidenav-7">
        <li class="nav-item">
    <a class="nav-link" href="/docs/reference/widgets">Flutter Widget 目录</a>
  </li><li class="nav-item">
    <a class="nav-link" href="https://docs.flutter.cn" target="_blank" rel="noopener">Flutter API 文档<i class="fas fa-external-link-alt"></i></a>
  </li><li class="nav-item">
    <a class="nav-link" href="https://pub.flutter-io.cn/flutter" target="_blank" rel="noopener">Package 网站<i class="fas fa-external-link-alt"></i></a>
  </li>
</ul>
    </li></ul>

    </div>
    <div id="site-toc--side" class="site-toc site-toc--side fixed-col col-xl-2 order-3" data-fixed-column="">
  <header class="site-toc__title">
    Contents
    <button type="button" class="btn site-toc--button__page-top" aria-label="Page top"></button>
    </header>
  <ul class="section-nav nav">
<li class="toc-entry nav-item toc-h2"><a class="nav-link" href="#our-example-">Our example </a></li>
<li class="toc-entry nav-item toc-h2"><a class="nav-link" href="#lifting-state-up">Lifting state up</a></li>
<li class="toc-entry nav-item toc-h2"><a class="nav-link" href="#accessing-the-state">Accessing the state</a></li>
<li class="toc-entry nav-item toc-h2"><a class="nav-link" href="#model">Model</a></li>
<li class="toc-entry nav-item toc-h2"><a class="nav-link" href="#scopedmodel">ScopedModel</a></li>
<li class="toc-entry nav-item toc-h2"><a class="nav-link" href="#scopedmodeldescendant">ScopedModelDescendant</a>
<ul class="nav">
<li class="toc-entry nav-item toc-h3"><a class="nav-link" href="#scopedmodelof">ScopedModel.of</a></li>
</ul>
</li>
<li class="toc-entry nav-item toc-h2"><a class="nav-link" href="#putting-it-all-together">Putting it all together</a></li>
</ul>
</div>
<main class="site-content col-12 col-md-9 offset-md-3 col-xl-8 offset-xl-2 col-xxl-8 offset-xxl-2" role="main">
      <div class="container">
        
        <nav class="site-nextprev-nav">
    <ul>
      <li class="prev">
          <a href="/docs/development/data-and-backend/state-mgmt/ephemeral-vs-app">短时 (ephemeral) 和共享 (app) 状态</a>
      </li>
      <li class="next">
          <a href="/docs/development/data-and-backend/state-mgmt/options">状态 (State) 管理参考</a>
      </li>
      </ul>
  </nav>

        <header class="site-content__title">
          <div id="page-github-links" class="btn-group" aria-label="Page GitHub links" role="group">
  <a href="https://github.com/cfug/flutter.cn/tree/master/src/docs/development/data-and-backend/state-mgmt/simple.md" class="btn no-automatic-external" title="View page source" target="_blank" rel="noopener">
    <i class="fas fa-file-alt fa-sm"></i>
  </a>
  <a href="https://github.com/cfug/flutter.cn/issues/new?title='简单的共享 (app) 状态管理' page issue&amp;body=
Page URL: https://flutter.dev/docs/development/data-and-backend/state-mgmt/simple.html%0D%0A
Page source: https://github.com/cfug/flutter.cn/tree/master/src/docs/development/data-and-backend/state-mgmt/simple.md%0D%0A
%0D%0A
Found a typo? You can fix it yourself by going to the page source and clicking the pencil icon. Or finish creating this issue.%0D%0A
%0D%0A
Description of issue:" class="btn no-automatic-external" title="Report an issue with this page" target="_blank" rel="noopener">
    <i class="fas fa-bug fa-sm"></i>
  </a>
</div>

          <h1 id="简单的共享-app-状态管理">简单的共享 (app) 状态管理</h1>
          

<nav aria-label="breadcrumb">
  <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
  <li class="breadcrumb-item" property="itemListElement" typeof="ListItem"><a href="/docs" property="item" typeof="WebPage"><span property="name">文档</span>
      </a>
      <meta property="position" content="1">
    </li>
  <li class="breadcrumb-item" property="itemListElement" typeof="ListItem"><a href="/docs/development" property="item" typeof="WebPage"><span property="name">开发文档</span>
      </a>
      <meta property="position" content="2">
    </li>
  <li class="breadcrumb-item" property="itemListElement" typeof="ListItem"><a href="/docs/development/data-and-backend" property="item" typeof="WebPage"><span property="name">数据调用和后端</span>
      </a>
      <meta property="position" content="3">
    </li>
  <li class="breadcrumb-item" property="itemListElement" typeof="ListItem"><a href="/docs/development/data-and-backend/state-mgmt" property="item" typeof="WebPage"><span property="name">状态 (State) 管理</span>
      </a>
      <meta property="position" content="4">
    </li>
  <li class="breadcrumb-item active" property="itemListElement" typeof="ListItem" aria-current="page"><a href="/docs/development/data-and-backend/state-mgmt/simple.html" property="item" typeof="WebPage"><span property="name">简单的共享 (app) 状态管理</span>
      </a>
      <meta property="position" content="5">
    </li>
  
  </ol>
</nav>
          </header>
        <div id="site-toc--inline" class="site-toc site-toc--inline ">
  <header class="site-toc__title">
    Contents
    </header>
  <ul class="section-nav">
<li class="toc-entry toc-h2"><a href="#our-example-">Our example </a></li>
<li class="toc-entry toc-h2"><a href="#lifting-state-up">Lifting state up</a></li>
<li class="toc-entry toc-h2"><a href="#accessing-the-state">Accessing the state</a></li>
<li class="toc-entry toc-h2"><a href="#model">Model</a></li>
<li class="toc-entry toc-h2"><a href="#scopedmodel">ScopedModel</a></li>
<li class="toc-entry toc-h2"><a href="#scopedmodeldescendant">ScopedModelDescendant</a>
<ul>
<li class="toc-entry toc-h3"><a href="#scopedmodelof">ScopedModel.of</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#putting-it-all-together">Putting it all together</a></li>
</ul>
</div>
<p>Now that you know about <a href="/docs/development/data-and-backend/state-mgmt/declarative">declarative UI
programming</a>
and the difference between <a href="/docs/development/data-and-backend/state-mgmt/ephemeral-vs-app">ephemeral and app
state</a>,
you are ready to learn about simple app state management.</p>

<p>On this page, we are going to be using the <code class="highlighter-rouge">scoped_model</code> package.
If you are new to Flutter and you don’t have a strong reason to choose
another approach (Redux, Rx, hooks, etc.), this is probably the approach
you should start with. <code class="highlighter-rouge">scoped_model</code> is easy to understand and it doesn’t
use much code. It also uses concepts that are applicable in every other
approach.</p>

<p>That said, if you have strong background in state management from other
reactive frameworks, you will find packages and tutorials listed on the
<a href="/docs/development/data-and-backend/state-mgmt/options">following page</a>.</p>

<h2 id="our-example-">
<a id="our-example-" class="anchor" href="#our-example-" aria-hidden="true"><span class="octicon octicon-link"></span></a>Our example <img alt="An animated gif showing a Flutter app in use. It starts with the user on a login screen. They log in and are taken to the catalog screen, with a list of items. The click on several items, and as they do so, the items are marked as added. The user clicks on a button and gets taken to the cart view. They see the items there. They go back to the catalog, and the items they bought still show added. End of animation." class="site-image-right" src="/assets/development/data-and-backend/state-mgmt/model-shopper-screencast-e0ada0e83cd8e7fdcad84167b8f7ffd7eb5ef85b0cb8957f03c6f05bd16b1cea.gif">
</h2>

<p>For illustration, consider the following simple app.</p>

<p>The app has three separate screens: a login prompt, a catalog,
and a cart (represented by the <code class="highlighter-rouge">MyLoginScreen</code>, <code class="highlighter-rouge">MyCatalog</code>,
and <code class="highlighter-rouge">MyCart</code> widgets, respectively). It could be a shopping app,
but you can imagine the same structure in a simple social networking
app (replace catalog for “wall” and cart for “favorites”).</p>

<p>The catalog screen includes a custom app bar (<code class="highlighter-rouge">MyAppBar</code>)
and a scrolling view of many list items (<code class="highlighter-rouge">MyListItems</code>).</p>

<p>Here’s the app visualized as a widget tree.</p>

<p><img alt="A widget tree with MyApp at the top, and MyLoginScreen, MyCatalog and MyCart below it. MyLoginScreen and MyCart area leaf nodes, but MyCatalog have two children: MyAppBar and a list of MyListItems." src="/assets/development/data-and-backend/state-mgmt/simple-widget-tree-19cb2528c56ef04924de364b4d0e08b73f4bcf7231aad0d6bc0eb1919e543fb9.png"></p>

<p>So we have at least 6 subclasses of <code class="highlighter-rouge">Widget</code>. Many of them will need
access to state that “belongs” elsewhere. For example, each
<code class="highlighter-rouge">MyListItem</code> will want to be able to add to cart. It might also want
to see if the item that it’s displaying is already in the cart.</p>

<p>This takes us to our first question: where should we put the current
state of the cart?</p>

<h2 id="lifting-state-up">
<a id="lifting-state-up" class="anchor" href="#lifting-state-up" aria-hidden="true"><span class="octicon octicon-link"></span></a>Lifting state up</h2>

<p>In Flutter, it makes sense to keep the state above the widgets that use it.</p>

<p>Why? In declarative frameworks like Flutter, if you want to change the UI,
you have to rebuild it. There is no easy way to have
<code class="highlighter-rouge">MyCart.updateWith(somethingNew)</code>. In other words, it’s hard to
imperatively change a widget from outside, by calling a method on it.
And even if you could make this work, you would be fighting the
framework instead of letting it help you.</p>

<!-- skip -->
<div class="language-dart highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// BAD: DO NOT DO THIS</span>
<span class="kt">void</span> <span class="nf">myTapHandler</span><span class="p">(</span><span class="o">)</span> <span class="o">{</span>
  <span class="kd">var</span> <span class="n">cartWidget</span> <span class="o">=</span> <span class="n">somehowGetMyCartWidget</span><span class="o">();</span>
  <span class="n">cartWidget</span><span class="o">.</span><span class="na">updateWith</span><span class="o">(</span><span class="n">item</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Even if you get the above code to work, you will then have to deal
with the following in the <code class="highlighter-rouge">MyCart</code> widget:</p>

<!-- skip -->
<div class="language-dart highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// BAD: DO NOT DO THIS</span>
<span class="n">Widget</span> <span class="nf">build</span><span class="p">(</span><span class="n">BuildContext</span> <span class="n">context</span><span class="o">)</span> <span class="o">{</span>
  <span class="k">return</span> <span class="n">SomeWidget</span><span class="o">(</span>
    <span class="c1">// The initial state of the cart.</span>
  <span class="o">);</span>
<span class="o">}</span>

<span class="kt">void</span> <span class="nf">updateWith</span><span class="p">(</span><span class="n">Item</span> <span class="n">item</span><span class="o">)</span> <span class="o">{</span>
  <span class="c1">// Somehow you need to change the UI from here.</span>
<span class="o">}</span>
</code></pre></div></div>

<p>You would need to take into consideration the current state of the UI
and apply the new data to it. It’s hard to avoid bugs this way.</p>

<p>In Flutter, you construct a new widget every time its contents change.
Instead of <code class="highlighter-rouge">MyCart.updateWith(somethingNew)</code> (a method call)
you use <code class="highlighter-rouge">MyCart(contents)</code> (a constructor). Because you can only
construct new widgets in the build methods of their parents,
if you want to change <code class="highlighter-rouge">contents</code>, it needs to live in <code class="highlighter-rouge">MyCart</code>’s
parent or above.</p>

<div class="code-excerpt">
<div class="code-excerpt__code"><pre class="prettyprint lang-dart">// GOOD
void myTapHandler(BuildContext context) {
  var cartModel = somehowGetMyCartModel(context);
  cartModel.add(item);
}</pre></div>
</div>

<p>Now <code class="highlighter-rouge">MyCart</code> has only one code path for building any version of the UI.</p>

<div class="code-excerpt">
<div class="code-excerpt__code"><pre class="prettyprint lang-dart">// GOOD
Widget build(BuildContext context) {
  var cartModel = somehowGetMyCartModel(context);
  return SomeWidget(
    // Just construct the UI once, using the current state of the cart.
    // ···
  );
}</pre></div>
</div>

<p>In our example, <code class="highlighter-rouge">contents</code> needs to live in <code class="highlighter-rouge">MyApp</code>. Whenever it changes,
it rebuilds <code class="highlighter-rouge">MyCart</code> from above (more on that later). Because of this,
<code class="highlighter-rouge">MyCart</code> doesn’t need to worry about lifecycle—it just declares
what to show for any given <code class="highlighter-rouge">contents</code>. When that changes, the old
<code class="highlighter-rouge">MyCart</code> widget disappears and is completely replaced by the new one.</p>

<p><img alt="Same widget tree as above, but now we show a small 'cart' badge next to MyApp, and there are two arrows here. One comes from one of the MyListItems to the 'cart', and another one goes from the 'cart' to the MyCart widget." src="/assets/development/data-and-backend/state-mgmt/simple-widget-tree-with-cart-088b22c4ef4e4389a1cababaceaadcd36ba3de37613080942885263c36e29595.png"></p>

<p>This is what we mean when we say that widgets are immutable.
They don’t change—they get replaced.</p>

<p>Now that we know where to put the state of the cart, let’s see how
to access it.</p>

<h2 id="accessing-the-state">
<a id="accessing-the-state" class="anchor" href="#accessing-the-state" aria-hidden="true"><span class="octicon octicon-link"></span></a>Accessing the state</h2>

<p>When user clicks on one of the items in the catalog,
it’s added to the cart. But since the cart lives above <code class="highlighter-rouge">MyListItem</code>,
how do we do that?</p>

<p>A simple option is to provide a callback that <code class="highlighter-rouge">MyListItem</code> can call
when it is clicked. Dart’s functions are first class objects,
so you can pass them around any way you want. So, inside
<code class="highlighter-rouge">MyCatalog</code> you can have the following:</p>

<div class="code-excerpt">
<div class="code-excerpt__code"><pre class="prettyprint lang-dart">@override
Widget build(BuildContext context) {
  return SomeWidget(
    // Construct the widget, passing it a reference to the method above.
    MyListItem(myTapCallback),
  );
}

void myTapCallback(Item item) {
  print('user tapped on $item');
}</pre></div>
</div>

<p>This works okay, but for app state that you need to modify from
many different places, you’d have to pass around a lot of
callbacks—which gets old pretty quickly.</p>

<p>Fortunately, Flutter has mechanisms for widgets to provide data and
services to their descendants (in other words, not just their children,
but any widgets below them). As you would expect from Flutter,
where <em>Everything is a Widget™</em>, these mechanisms are just special
kinds of widgets—<code class="highlighter-rouge">InheritedWidget</code>, <code class="highlighter-rouge">InheritedNotifier</code>,
<code class="highlighter-rouge">InheritedModel</code>, and more. We won’t be covering those here,
because they are a bit low-level for what we’re trying to do.</p>

<p>Instead, we are going to use a package that works with the low-level
widgets but is simple to use. It’s called <code class="highlighter-rouge">scoped_model</code>.</p>

<p>With <code class="highlighter-rouge">scoped_model</code>, you don’t need to worry about callbacks or
<code class="highlighter-rouge">InheritedWidgets</code>. But you do need to understand 3 concepts:</p>

<ul>
  <li>Model</li>
  <li>ScopedModel</li>
  <li>ScopedModelDescendant</li>
</ul>

<h2 id="model">
<a id="model" class="anchor" href="#model" aria-hidden="true"><span class="octicon octicon-link"></span></a>Model</h2>

<p>In <code class="highlighter-rouge">scoped_model</code>, the <code class="highlighter-rouge">Model</code> encapsulates your application state.
For very simple apps, you get by with a single model. In complex ones,
you’ll have several models.</p>

<p>In our shopping app example, we want to manage the state of the cart in a
<code class="highlighter-rouge">Model</code>. We create a new class that extends Model. Like so:</p>

<div class="code-excerpt">
<div class="code-excerpt__code"><pre class="prettyprint lang-dart">class CartModel extends Model {
  /// Internal, private state of the cart.
  final List&lt;Item&gt; _items = [];

  /// An unmodifiable view of the items in the cart.
  UnmodifiableListView&lt;Item&gt; get items =&gt; UnmodifiableListView(_items);

  /// The current total price of all items (assuming all items cost $1).
  int get totalPrice =&gt; _items.length;

  /// Adds [item] to cart. This is the only way to modify the cart from outside.
  void add(Item item) {
    _items.add(item);
    // This call tells [Model] that it should rebuild the widgets that
    // depend on it.
    notifyListeners();
  }
}</pre></div>
</div>

<p>The only code that is specific to <code class="highlighter-rouge">Model</code> is the call to <code class="highlighter-rouge">notifyListeners()</code>.
Call this method any time the model changes in a way that might change your
app’s UI. Everything else in <code class="highlighter-rouge">CartModel</code> is the model itself and its business
logic.</p>

<p>Model doesn’t depend on any high-level classes in Flutter, so it’s easily
testable (you don’t even need to use <a href="/docs/testing#widget-testing">widget
testing</a> for it). For example,
here’s a simple unit test of CartModel:</p>

<div class="code-excerpt">
<div class="code-excerpt__code"><pre class="prettyprint lang-dart">test('adding item increases total cost', () {
  final cart = CartModel();
  final startingPrice = cart.totalPrice;
  cart.addListener(() {
    expect(cart.totalPrice, greaterThan(startingPrice));
  });
  cart.add(Item('Dash'));
});</pre></div>
</div>

<p>But <code class="highlighter-rouge">Model</code> really starts to make sense when used with the rest of the
<code class="highlighter-rouge">scoped_model</code> package.</p>

<h2 id="scopedmodel">
<a id="scopedmodel" class="anchor" href="#scopedmodel" aria-hidden="true"><span class="octicon octicon-link"></span></a>ScopedModel</h2>

<p><code class="highlighter-rouge">ScopedModel</code> is the widget that provides an instance of <code class="highlighter-rouge">Model</code> to its
descendants.</p>

<p>We already know where to put it: above the widgets that will need to access it.
In the case of <code class="highlighter-rouge">CartModel</code>, that means somewhere above both <code class="highlighter-rouge">MyCart</code>
and <code class="highlighter-rouge">MyCatalog</code>.</p>

<p>You don’t want to place <code class="highlighter-rouge">ScopedModel</code> higher than necessary
(because you don’t want to pollute the scope). But in our case,
the only widget that is on top of both <code class="highlighter-rouge">MyCart</code> and <code class="highlighter-rouge">MyCatalog</code> is <code class="highlighter-rouge">MyApp</code>.</p>

<div class="code-excerpt">
<div class="code-excerpt__code"><pre class="prettyprint lang-dart">void main() {
  final cart = CartModel();

  // You could optionally connect [cart] with some database here.

  runApp(
    ScopedModel&lt;CartModel&gt;(
      model: cart,
      child: MyApp(),
    ),
  );
}</pre></div>
</div>

<p>Note that we’re creating <code class="highlighter-rouge">ScopedModel&lt;CartModel&gt;</code> (read: “ScopedModel
of CartModel”). The <code class="highlighter-rouge">scoped_model</code> package relies on types to find the
right model, and the <code class="highlighter-rouge">&lt;CartModel&gt;</code> part makes it clear what type we’re
providing here.</p>

<p>If you want to provide more than one model, you need to nest the ScopedModels:</p>

<!-- skip -->
<div class="language-dart highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ScopedModel</span><span class="o">&lt;</span><span class="n">SomeOtherModel</span><span class="o">&gt;(</span>
  <span class="nl">model:</span> <span class="n">myOtherModel</span><span class="o">,</span>
  <span class="nl">child:</span> <span class="n">ScopedModel</span><span class="o">&lt;</span><span class="n">CartModel</span><span class="o">&gt;(</span>
    <span class="nl">model:</span> <span class="n">cart</span><span class="o">,</span>
    <span class="nl">child:</span> <span class="n">MyApp</span><span class="o">(),</span>
  <span class="o">),</span>
<span class="o">)</span>
</code></pre></div></div>

<h2 id="scopedmodeldescendant">
<a id="scopedmodeldescendant" class="anchor" href="#scopedmodeldescendant" aria-hidden="true"><span class="octicon octicon-link"></span></a>ScopedModelDescendant</h2>

<p>Now that <code class="highlighter-rouge">CartModel</code> is provided to widgets in our app through the
<code class="highlighter-rouge">ScopedModel&lt;CartModel&gt;</code> declaration at the top, we can start using it.</p>

<p>This is done through the <code class="highlighter-rouge">ScopedModelDescendant</code> widget.</p>

<div class="code-excerpt">
<div class="code-excerpt__code"><pre class="prettyprint lang-dart">return ScopedModelDescendant&lt;CartModel&gt;(
  builder: (context, child, cart) {
    return Text("Total price: ${cart.totalPrice}");
  },
);</pre></div>
</div>

<p>We must specify the type of the model that we want to access.
In this case, we want <code class="highlighter-rouge">CartModel</code>, so we write
<code class="highlighter-rouge">ScopedModelDescendant&lt;CartModel&gt;</code>. If you don’t specify
the generic (<code class="highlighter-rouge">&lt;CartModel&gt;</code>), the <code class="highlighter-rouge">scoped_model</code> package
won’t be able to help you. As mentioned above,
<code class="highlighter-rouge">scoped_model</code> is based on types, and without the type,
it doesn’t know what you want.</p>

<p>The only required argument of the <code class="highlighter-rouge">ScopedModelDescendant</code> widget
is the builder. Builder is a function that is called whenever the
model changes. (In other words, when you call <code class="highlighter-rouge">notifyListeners()</code>
in your model, all the builder methods of all the corresponding
<code class="highlighter-rouge">ScopedModelDescendant</code> widgets are called.)</p>

<p>The builder is called with three attributes. The first one is <code class="highlighter-rouge">context</code>,
which you also get in every build method.</p>

<p>The second attribute is <code class="highlighter-rouge">child</code>, which is there for optimization.
If you have a large widget subtree under your <code class="highlighter-rouge">ScopedModelDescendant</code>
that <em>doesn’t</em> change when the model changes, you can construct it
once and get it through the builder.</p>

<div class="code-excerpt">
<div class="code-excerpt__code"><pre class="prettyprint lang-dart">return ScopedModelDescendant&lt;CartModel&gt;(
  builder: (context, child, cart) =&gt; Stack(
        children: [
          // Use SomeExpensiveWidget here, without rebuilding every time.
          child,
          Text("Total price: ${cart.totalPrice}"),
        ],
      ),
  // Build the expensive widget here.
  child: SomeExpensiveWidget(),
);</pre></div>
</div>

<p>The third argument of the builder function is the model. That’s
what we were asking for in the first place. You can use the data
in the model to define what the UI should look like at any given point.</p>

<p>It is best practice to put your <code class="highlighter-rouge">ScopedModelDescendant</code> widgets as
deep in the tree as possible. You don’t want to rebuild large portions
of the UI just because some detail somewhere changed.</p>

<div class="code-excerpt">
<div class="code-excerpt__code"><pre class="prettyprint lang-dart">// DON'T DO THIS
return ScopedModelDescendant&lt;CartModel&gt;(
  builder: (context, child, cart) {
    return HumongousWidget(
      // ...
      child: AnotherMonstrousWidget(
        // ...
        child: Text('Total price: ${cart.totalPrice}'),
      ),
    );
  },
);</pre></div>
</div>

<p>Instead:</p>

<div class="code-excerpt">
<div class="code-excerpt__code"><pre class="prettyprint lang-dart">// DO THIS
return HumongousWidget(
  // ...
  child: AnotherMonstrousWidget(
    // ...
    child: ScopedModelDescendant&lt;CartModel&gt;(
      builder: (context, child, cart) {
        return Text('Total price: ${cart.totalPrice}');
      },
    ),
  ),
);</pre></div>
</div>

<h3 id="scopedmodelof">
<a id="scopedmodelof" class="anchor" href="#scopedmodelof" aria-hidden="true"><span class="octicon octicon-link"></span></a>ScopedModel.of</h3>

<p>Sometimes, you don’t really need the <em>data</em> in the model to change the
UI but you still need to access it. For example, a <code class="highlighter-rouge">ClearCart</code>
button wants to allow the user to remove everything from the cart.
It doesn’t need to display the contents of the cart,
it just needs to call the <code class="highlighter-rouge">clear()</code> method.</p>

<p>We could use <code class="highlighter-rouge">ScopedModelDescendant&lt;CartModel&gt;</code> for this,
but that would be wasteful. We’d be asking the framework to
rebuild a widget that doesn’t need to be rebuilt.</p>

<p>For this use case, we can use <code class="highlighter-rouge">ScopedModel.of</code>.</p>

<div class="code-excerpt">
<div class="code-excerpt__code"><pre class="prettyprint lang-dart">ScopedModel.of&lt;CartModel&gt;(context).add(item);</pre></div>
</div>

<p>Using the above line in a build method will not cause this widget to
rebuild when <code class="highlighter-rouge">notifyListeners</code> is called.</p>

<p>Note: You can also use <code class="highlighter-rouge">ScopedModelDescendant&lt;CartModel&gt;(builder: myBuilder,
rebuildOnChange: false)</code> but that’s longer and requires you to define the
builder function.</p>

<h2 id="putting-it-all-together">
<a id="putting-it-all-together" class="anchor" href="#putting-it-all-together" aria-hidden="true"><span class="octicon octicon-link"></span></a>Putting it all together</h2>

<p>You can <a href="https://github.com/filiph/samples/tree/scoped-model-shopper/model_shopper">check out the
example</a>
covered in this article. If you want something simpler,
you can see how the simple Counter app looks like when <a href="https://github.com/flutter/samples/tree/master/scoped_model_counter">built with
scoped_model</a>.</p>

<p>When you’re ready to play around with <code class="highlighter-rouge">scoped_model</code> yourself,
don’t forget to add the dependency on it to your <code class="highlighter-rouge">pubspec.yaml</code> first.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">name</span><span class="pi">:</span> <span class="s">my_name</span>
<span class="na">description</span><span class="pi">:</span> <span class="s">Blah blah blah.</span>

<span class="c1"># ...</span>

<span class="na">dependencies</span><span class="pi">:</span>
  <span class="na">flutter</span><span class="pi">:</span>
    <span class="na">sdk</span><span class="pi">:</span> <span class="s">flutter</span>

  <span class="na">scoped_model</span><span class="pi">:</span> <span class="s">^1.0.0</span>

<span class="na">dev_dependencies</span><span class="pi">:</span>
  <span class="c1"># ...</span>
</code></pre></div></div>

<p>Now you can <code class="highlighter-rouge">import 'package:scoped_model/scoped_model.dart';</code>
and start building.</p>

        <nav class="site-nextprev-nav">
    <ul>
      <li class="prev">
          <a href="/docs/development/data-and-backend/state-mgmt/ephemeral-vs-app">短时 (ephemeral) 和共享 (app) 状态</a>
      </li>
      <li class="next">
          <a href="/docs/development/data-and-backend/state-mgmt/options">状态 (State) 管理参考</a>
      </li>
      </ul>
  </nav>

      </div>
    </main>
  </div>
</div>
<footer class="site-footer">
  <div class="container-fluid">
    <div class="row">
      <div class="col-md-12 site-footer__wrapper">
        <div class="site-footer__logo">
          <img src="/images/flutter-mono-81x100.png" alt="Flutter Logo" width="81" height="100">
        </div>
        <div class="site-footer__content">
          <ul class="site-footer__link-list">
              <li><a href="https://groups.google.com/forum/#!forum/flutter-dev">flutter-dev@</a></li>
              <li><a href="/tos">terms</a></li>
              <li><a href="/security">security</a></li>
              <li><a href="https://www.google.com/intl/en/policies/privacy">privacy</a></li>
              <li><a href="https://flutter-es.io/">español</a></li>
              <li><a href="https://flutter-io.cn" class="text-nowrap">社区中文资源</a></li>
          </ul>

          <p class="licenses" translation-origin="on">
            Except as otherwise noted,
            this work is licensed under a
            <a rel="license" href="https://creativecommons.org/licenses/by/4.0">Creative
            Commons Attribution 4.0 International License</a>,
            and code samples are licensed under the BSD License.
          </p>
          <p class="licenses" translation-result="off">
            除非特别说明，否则本站内容采用 <a rel="license" href="https://creativecommons.org/licenses/by/4.0">CC BY 4.0 授权协议</a>，所有范例代码都采用 BSD 授权协议。
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>


    <!-- <script async="" defer="" src="//survey.g.doubleclick.net/async_survey?site=at3ul57xpub2vk3oxt2ytw365i"></script> -->
  

<script src="/assets/translator/js/translator.js"></script></body></html>